<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Server Selector Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #1a1a1a;
            color: white;
        }
        
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border: 1px solid #444;
        }
        
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .test-button:hover {
            background: #0056b3;
        }
        
        .player-container {
            width: 100%;
            height: 400px;
            position: relative;
            background: #000;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .player-container video {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .player-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .info-box {
            background: #333;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #007bff;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 5px 0;
            border-bottom: 1px solid #444;
        }
        
        .feature-list li:before {
            content: "‚úÖ ";
            color: #28a745;
        }
        
        .code-block {
            background: #1e1e1e;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            overflow-x: auto;
            border: 1px solid #444;
        }
    </style>
</head>
<body>
    <h1>üåê Universal Server Selector Test</h1>
    
    <div class="info-box">
        <h3>üéØ What This Tests</h3>
        <p>The Universal Server Selector is designed to work with <strong>BOTH</strong> direct video links (MP4, M3U8, MPD) and embedded sources (vidsrc, vidjoy, mega, etc.).</p>
    </div>
    
    <div class="test-section">
        <h3>üìã Test Scenarios</h3>
        <p>Click any button below to test different server configurations:</p>
        
        <button class="test-button" onclick="testDirectLinks()">üé¨ Test Direct Video Links (MP4/M3U8)</button>
        <button class="test-button" onclick="testEmbeddedLinks()">üîó Test Embedded Sources (vidsrc/vidjoy)</button>
        <button class="test-button" onclick="testMixedSources()">üîÑ Test Mixed Source Types</button>
        <button class="test-button" onclick="testSingleServer()">üì∫ Test Single Server (No Selector)</button>
    </div>
    
    <div class="player-container" id="player-container">
        <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666;">
            <div style="text-align: center;">
                <h3>üé• Player Area</h3>
                <p>Click a test button above to see the server selector in action</p>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h3>üîß How It Works</h3>
        <ul class="feature-list">
            <li><strong>Direct Links:</strong> MP4, M3U8, MPD files - uses Plyr.js player</li>
            <li><strong>Embedded Sources:</strong> vidsrc, vidjoy, mega.nz, Google Drive - uses iframe</li>
            <li><strong>Automatic Detection:</strong> System detects source type and shows appropriate player</li>
            <li><strong>Server Switching:</strong> Users can switch between servers seamlessly</li>
            <li><strong>Quality Indicators:</strong> Visual icons for different quality levels (1080p, 720p, etc.)</li>
            <li><strong>Floating Button:</strong> "üåê X Servers" button appears when multiple servers exist</li>
        </ul>
    </div>
    
    <div class="test-section">
        <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
        <ul class="feature-list">
            <li><strong>Ctrl+S:</strong> Toggle server selector visibility</li>
            <li><strong>Escape:</strong> Close server selector</li>
        </ul>
    </div>
    
    <div class="test-section">
        <h3>üìä JSON Data Structure</h3>
        <p>The system works with this JSON structure:</p>
        <div class="code-block">
{
  "Servers": [
    {"name": "1080p", "url": "https://example.com/video-1080p.mp4"},
    {"name": "720p", "url": "https://example.com/video-720p.mp4"},
    {"name": "vidsrc", "url": "https://vidsrc.to/embed/movie/123"}
  ]
}
        </div>
    </div>
    
    <div class="test-section">
        <h3>üéØ Key Features</h3>
        <ul class="feature-list">
            <li><strong>Universal:</strong> Works with both Plyr and iframe players</li>
            <li><strong>Dynamic:</strong> Only appears when multiple servers exist</li>
            <li><strong>Responsive:</strong> Adapts to different screen sizes</li>
            <li><strong>Accessible:</strong> Keyboard navigation and screen reader support</li>
            <li><strong>Fallback:</strong> Automatic server switching on failure</li>
        </ul>
    </div>

    <script>
        // Mock server data for testing
        const mockServers = {
            direct: [
                { name: "1080p", url: "https://sample-videos.com/zip/10/mp4/SampleVideo_1080x1920_1MB.mp4" },
                { name: "720p", url: "https://sample-videos.com/zip/10/mp4/SampleVideo_720x1280_1MB.mp4" },
                { name: "480p", url: "https://sample-videos.com/zip/10/mp4/SampleVideo_480x640_1MB.mp4" }
            ],
            embedded: [
                { name: "vidsrc", url: "https://vidsrc.to/embed/movie/tt0111161" },
                { name: "vidjoy", url: "https://vidjoy.net/embed/tt0111161" },
                { name: "mega", url: "https://mega.nz/embed/example" }
            ],
            mixed: [
                { name: "1080p", url: "https://sample-videos.com/zip/10/mp4/SampleVideo_1080x1920_1MB.mp4" },
                { name: "vidsrc", url: "https://vidsrc.to/embed/movie/tt0111161" },
                { name: "720p", url: "https://sample-videos.com/zip/10/mp4/SampleVideo_720x1280_1MB.mp4" }
            ],
            single: [
                { name: "720p", url: "https://sample-videos.com/zip/10/mp4/SampleVideo_720x1280_1MB.mp4" }
            ]
        };

        // Simulate the universal server selector
        function createTestServerSelector(servers, currentServer = null) {
            if (!servers || servers.length <= 1) return;
            
            // Remove existing selector
            const existingSelector = document.getElementById('universal-server-selector');
            if (existingSelector) {
                existingSelector.remove();
            }
            
            // Remove existing indicator
            const existingIndicator = document.getElementById('server-selector-indicator');
            if (existingIndicator) {
                existingIndicator.remove();
            }
            
            // Create server selector container
            const selectorContainer = document.createElement('div');
            selectorContainer.id = 'universal-server-selector';
            selectorContainer.style.cssText = `
                position: absolute;
                top: 10px;
                right: 10px;
                z-index: 1000;
                background: rgba(0, 0, 0, 0.9);
                border-radius: 12px;
                padding: 15px;
                min-width: 250px;
                backdrop-filter: blur(15px);
                border: 1px solid rgba(255, 255, 255, 0.2);
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
                max-height: 400px;
                overflow-y: auto;
            `;
            
            // Create title
            const title = document.createElement('div');
            title.style.cssText = `
                color: white;
                font-size: 16px;
                font-weight: bold;
                margin-bottom: 15px;
                text-align: center;
                padding-bottom: 10px;
                border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            `;
            title.textContent = 'üåê Server Selection';
            selectorContainer.appendChild(title);
            
            // Create server list
            const serverList = document.createElement('div');
            serverList.style.cssText = `
                display: flex;
                flex-direction: column;
                gap: 8px;
            `;
            
            servers.forEach((server, index) => {
                const serverItem = document.createElement('div');
                serverItem.style.cssText = `
                    padding: 12px 16px;
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 8px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    color: white;
                    font-size: 14px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    border: 2px solid transparent;
                `;
                
                // Highlight current server
                const isCurrentServer = currentServer && server.url === currentServer.url;
                if (isCurrentServer) {
                    serverItem.style.background = 'rgba(59, 130, 246, 0.6)';
                    serverItem.style.border = '2px solid rgba(59, 130, 246, 0.8)';
                }
                
                // Server name with quality indicator
                const serverName = document.createElement('span');
                serverName.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 8px;
                `;
                
                // Add quality icon based on server name
                let qualityIcon = 'üì∫';
                if (server.name) {
                    if (server.name.includes('1080p') || server.name.includes('1080')) {
                        qualityIcon = 'üé¨';
                    } else if (server.name.includes('720p') || server.name.includes('720')) {
                        qualityIcon = 'üì∫';
                    } else if (server.name.includes('480p') || server.name.includes('480')) {
                        qualityIcon = 'üì±';
                    } else if (server.name.includes('360p') || server.name.includes('360')) {
                        qualityIcon = 'üì±';
                    } else if (server.name.includes('vidsrc')) {
                        qualityIcon = 'üîó';
                    } else if (server.name.includes('vidjoy')) {
                        qualityIcon = 'üîó';
                    } else if (server.name.includes('mega')) {
                        qualityIcon = 'üîó';
                    }
                }
                
                serverName.innerHTML = `${qualityIcon} ${server.name || `Server ${index + 1}`}`;
                serverItem.appendChild(serverName);
                
                // Server status indicator
                const statusIndicator = document.createElement('span');
                statusIndicator.style.cssText = `
                    width: 10px;
                    height: 10px;
                    border-radius: 50%;
                    background: #10b981;
                    margin-left: 12px;
                    box-shadow: 0 0 8px rgba(16, 185, 129, 0.6);
                `;
                serverItem.appendChild(statusIndicator);
                
                // Add hover effects
                serverItem.addEventListener('mouseenter', () => {
                    if (!isCurrentServer) {
                        serverItem.style.background = 'rgba(255, 255, 255, 0.2)';
                        serverItem.style.transform = 'translateX(3px)';
                    }
                });
                
                serverItem.addEventListener('mouseleave', () => {
                    if (isCurrentServer) {
                        serverItem.style.background = 'rgba(59, 130, 246, 0.6)';
                    } else {
                        serverItem.style.background = 'rgba(255, 255, 255, 0.1)';
                    }
                    serverItem.style.transform = 'translateX(0)';
                });
                
                // Add click handler
                serverItem.addEventListener('click', () => {
                    if (!isCurrentServer) {
                        // Simulate server switch
                        alert(`Switching to: ${server.name} (${server.url})`);
                        
                        // Update visual selection
                        document.querySelectorAll('#universal-server-selector .server-item').forEach(item => {
                            item.style.background = 'rgba(255, 255, 255, 0.1)';
                            item.style.border = '2px solid transparent';
                        });
                        serverItem.style.background = 'rgba(59, 130, 246, 0.6)';
                        serverItem.style.border = '2px solid rgba(59, 130, 246, 0.8)';
                    }
                });
                
                serverItem.className = 'server-item';
                serverList.appendChild(serverItem);
            });
            
            selectorContainer.appendChild(serverList);
            
            // Add close button
            const closeButton = document.createElement('button');
            closeButton.style.cssText = `
                position: absolute;
                top: 8px;
                right: 8px;
                background: rgba(255, 255, 255, 0.1);
                border: none;
                color: white;
                font-size: 18px;
                cursor: pointer;
                padding: 4px 8px;
                border-radius: 6px;
                transition: all 0.2s ease;
                width: 32px;
                height: 32px;
                display: flex;
                align-items: center;
                justify-content: center;
            `;
            closeButton.innerHTML = '√ó';
            closeButton.addEventListener('click', () => {
                selectorContainer.remove();
                const indicatorButton = document.getElementById('server-selector-indicator');
                if (indicatorButton) {
                    indicatorButton.remove();
                }
            });
            
            selectorContainer.appendChild(closeButton);
            
            // Add to player container
            const playerContainer = document.getElementById('player-container');
            if (playerContainer) {
                playerContainer.appendChild(selectorContainer);
                
                // Add floating indicator button
                const indicatorButton = document.createElement('div');
                indicatorButton.id = 'server-selector-indicator';
                indicatorButton.style.cssText = `
                    position: absolute;
                    top: 10px;
                    left: 10px;
                    background: rgba(59, 130, 246, 0.9);
                    color: white;
                    padding: 8px 12px;
                    border-radius: 20px;
                    font-size: 12px;
                    cursor: pointer;
                    z-index: 999;
                    backdrop-filter: blur(10px);
                    border: 1px solid rgba(255, 255, 255, 0.3);
                    transition: all 0.3s ease;
                    opacity: 0.8;
                    font-weight: 500;
                    box-shadow: 0 4px 16px rgba(59, 130, 246, 0.4);
                `;
                indicatorButton.innerHTML = `üåê ${servers.length} Servers`;
                indicatorButton.title = 'Click to show server selector';
                
                indicatorButton.addEventListener('click', () => {
                    selectorContainer.style.display = 'block';
                    selectorContainer.style.opacity = '1';
                });
                
                playerContainer.appendChild(indicatorButton);
            }
        }

        // Test functions
        function testDirectLinks() {
            const container = document.getElementById('player-container');
            container.innerHTML = '<video controls style="width: 100%; height: 100%; object-fit: contain;"><source src="https://sample-videos.com/zip/10/mp4/SampleVideo_1080x1920_1MB.mp4" type="video/mp4"></video>';
            createTestServerSelector(mockServers.direct, mockServers.direct[0]);
        }
        
        function testEmbeddedLinks() {
            const container = document.getElementById('player-container');
            container.innerHTML = '<iframe src="https://vidsrc.to/embed/movie/tt0111161" style="width: 100%; height: 100%; border: none;"></iframe>';
            createTestServerSelector(mockServers.embedded, mockServers.embedded[0]);
        }
        
        function testMixedSources() {
            const container = document.getElementById('player-container');
            container.innerHTML = '<video controls style="width: 100%; height: 100%; object-fit: contain;"><source src="https://sample-videos.com/zip/10/mp4/SampleVideo_1080x1920_1MB.mp4" type="video/mp4"></video>';
            createTestServerSelector(mockServers.mixed, mockServers.mixed[0]);
        }
        
        function testSingleServer() {
            const container = document.getElementById('player-container');
            container.innerHTML = '<video controls style="width: 100%; height: 100%; object-fit: contain;"><source src="https://sample-videos.com/zip/10/mp4/SampleVideo_720x1280_1MB.mp4" type="video/mp4"></video>';
            createTestServerSelector(mockServers.single, mockServers.single[0]);
        }

        // Add keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                const selector = document.getElementById('universal-server-selector');
                if (selector) {
                    selector.style.display = selector.style.display === 'none' ? 'block' : 'none';
                }
            } else if (e.key === 'Escape') {
                const selector = document.getElementById('universal-server-selector');
                const indicator = document.getElementById('server-selector-indicator');
                if (selector) selector.remove();
                if (indicator) indicator.remove();
            }
        });
    </script>
</body>
</html>